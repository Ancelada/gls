<!DOCTYPE HTML>

<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Our WebGl</title>
		{% load staticfiles %}

		<script type="text/javascript" src="{% static 'js/vendor/jquery.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/foundation.core.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/three.min.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/dat.gui.min.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/OrbitControls.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/stats.min.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/helvetiker_regular.typeface.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/ColladaLoader.js' %}"></script>


  		<link rel="stylesheet" href="{% static 'css/foundation.css' %}">
    	<link rel="stylesheet" href="{% static 'css/app.css' %}">


		<style>
			body{
				margin:0;
				overflow:hidden;
			}
		</style>
	</head>
	<body>
		{% csrf_token %}
		<!-- ***блок 3д изображения*** -->
		<!--************************-->
		<div id ="webGL-container"></div>
        <!-- ***блок панель управления*** -->
        <!--************************-->
        <button class="button show_hide_button">Панель инструментов</button>
        <div class="instrument_block large-3 small-5 columns" style="right:-100%;">
          
            <fieldset class="large-12 small-12 columns">
                <button class="close-button close_panel" aria-label="Close menu" type="button">
                    <span aria-hidden="true">x</span>
                </button>
                <h3 class="subheader">Объекты</h3>
                <ul class="vertical menu objects_tree" data-drilldown data-options="backButton:<li class='js-drilldown-back'><a>Назад</a></li>;">
                    {% for building in buildings %}
                    <li>
                        <a href="#">{{building.dae_BuildingName}}</a>
                        <ul class="vertical menu">
                        {% for floor in floors %}
                            {% if building.id == floor.Building_id %}
                                <li>
                                    <a href="#">{{floor.dae_FloorName}}</a>
                                    <ul class="vertical menu">
                                    {% for k in kabinet_n_outer %}
                                        {% if k.Floor_id == floor.id %}
                                        <li>
                                            <a href="#">{{k.dae_Kabinet_n_OuterName}}</a>
                                            <ul class="vertical menu">
                                                {% for wall in walls %}
                                                    {% if wall.Kabinet_n_Outer_id == k.id %}
                                                    <li>
                                                        <a href="#">{{wall.dae_WallName}}</a>    
                                                    </li>
                                                    {% endif %}
                                                {% endfor %}
                                            </ul>
                                        </li>
                                        {% endif %}
                                    {% endfor %}
                                    </ul>
                                </li>
                            {% endif %}
                        {% endfor %}
                        </ul>        
                    </li>
                    {% endfor %}                    
                </ul>
            </fieldset>
            <br>
            <br>
            <br>
            <fieldset class="large-12 small-12 columns">
                <a href="#" class="secodary hollow button large button_style" style="font-size:100%;">Навести камеру</a>    
            </fieldset>
            <fieldset class="large-12 small-12 columns">
                <h3 class="subheader">Видимость</h3>
                <ul class="tabs" data-tabs id="example-tabs">
                    <li class="tabs-title is-active"><a href="#panel1">Показать</a></li>
                    <li class="tabs-title"><a href="#panel2">Скрыть</a></li>
                </ul>
            </fieldset>
            <fieldset class="large-12 small-12 columns">
                <h3 class="subheader">Прозрачность</h3>
                <div class="slider" data-slider data-initial-start="1" data-start="0" data-end="1">
                    <span class="slider-handle" data-slider-handle role="slider" tabindex="1"></span>
                    <span class="slider-fill" data-slider-fill></span>
                    <input type="hidden" id="building_opacity">
                </div>
            </fieldset>
        </div>
		<!-- **********шейдеры ******-->
		<!--************************-->
		<script type="x-shader/x-vertex" id="vertexShader">

			varying vec3 vWorldPosition;
			void main() {

				vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
				vWorldPosition = worldPosition.xyz;

				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}
		</script>

		<script type="x-shader/x-fragment" id="fragmentShader">

			uniform vec3 topColor;
			uniform vec3 bottomColor;
			uniform float offset;
			uniform float exponent;

			varying vec3 vWorldPosition;

			void main() {

				float h = normalize( vWorldPosition + offset ).y;
				gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( h, exponent ), 0.0 ) ), 1.0 );

			}
		</script>
		<!--************************-->
<!--***********буфер**************-->
		<!--************************-->
	<script>
    $.getScript("/static/js/additional/instrument_panel.js");
	var unique = {};
	var cubeGeom = new THREE.BoxGeometry(0.5, 0.5, 0.5, 2, 2, 2);
	var cubeMaterial = new THREE.MeshLambertMaterial({color: 0x0000ff, transparent: true, opacity:0.8});
	var guiControls, datGUI;
    //массив объектов
    var colladaObjects = {}


	$(document).ready(function(){
		var marks;
		var unum = 0;
		var cron = 0;
		function getVal(){
			var csrf_token = $("input[name='csrfmiddlewaretoken']").val();
	        $.ajax({
	            type: 'POST',
	            url: '/getmarksvalues',
	            data: JSON.stringify(csrf_token),
              contentType: "application/json; charset=utf-8",
            	dataType: 'json',
            	async: false,
	            success: function(data, textStatus, jqXHR){
	            	if (marks){
	            		//проверка на повторение пачки
	            		function verify(){
	            			var doubled = 0;
		            		$.each(data, function(index){
		            			tag_id_new = data[index][0]['tag_id'];
		            			zone_new = data[index][0]['zone'];
		            			$.each(marks, function(index){
		            				tag_id_old = marks[index][0]['tag_id'];
		            				zone_old = marks[index][0]['zone'];
		            				if(tag_id_old == tag_id_new && zone_old == zone_new){
		            					doubled = 1;
		            					return false;
		            				}
		            			});
		            		});
		            		return doubled;
	            		}
	            		var result = verify();
            			//если пачка не повторяется записываем в буфер
	            		if(result == 0){
		            		$.each(data, function(index){
		            			//первая запись в буфере
		            			if(unique[0] == undefined){
		            					unique[0] = data[index][0];
		            					unum += 1;
            					} else {
            						//проверка на уникальность id в буфере
		            				//если нет, записать в массив
	            					tag_id_new = data[index][0]['tag_id'];
	            					doubled = 0;
	            					$.each(unique, function(index){
	            						tag_id_unique = unique[index]['tag_id'];
	            						if (tag_id_new == tag_id_unique){
	            							doubled = 1;
	            							return false;
	            						}
	            					});
	            					if (doubled==0){
	            						unique[unum] = data[index][0];
	            						unum += 1;
	            					}
            					}
		            		});
	            			//таймер, для отслеживания времения между посылками
	            			//переменная cron
	            			function timer(clear){
	            				var milisec = 0;
	            				timer = setInterval(function(){
	            					milisec += 10;
	            					cron = milisec;
	            					if (clear){
	            						milisec += 0;
	            					}
	            				}, 10);
	            			}
										timer(1);
										//запись в буфер позиций метки
										//в том числе повторяющихся
										//меток с разными позициями
										$.each(data, function(index){
											tag_id_new = data[index][0]['tag_id'];
											var ind = index;
											$.each(unique, function(index){
												tag_id_unique = unique[index]['tag_id'];
												if (tag_id_new == tag_id_unique){
													//при совпадении задаем список
													//записываем все повторяющиеся значения 
													unique[index]['data'] = [];
													uind = index;
													no=0;
													$.each(data, function(index){
														if (unique[uind]['tag_id'] == data[index][0]['tag_id']){
															unique[uind]['data'][no] = data[index][0];
															//количество позиций в пачке
															unique[uind]['count'] = no;
															//количество миллисекунд до обновления позиции
															unique[uind]['cron'] = cron;
															no+=1;	
														}
													});
													return false;
												}
											});
										});

										//передача буфера в рендер
										/*console.log(unique);*/
	            		}
	            		marks = data;//не удалять

	            	} else {
		            	marks = data;
	            	}
	            },
	        });
        }

        setInterval(getVal, 1000);
	});
	//************************
	//************************
	//сцена, фон, сетка, камера
	//инициализация
	//************************
	//************************

	//массив меток
	var cube = {};

    //глобальные переменные
	var dae;
	var camera;
	var spotLight;
	var cameraTarget;
	var renderer;
	var scene;

	// глобальный объект
	var center;

	function init(){

    /*сцена, камера */
    scene = new THREE.Scene();
    camera =  new THREE.PerspectiveCamera(85, window.innerWidth/window.innerHeight, .1, 1000);
    renderer = new THREE.WebGLRenderer({antialias:true});
    
    /*рендерер;*/
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMapEnabled= true;
    renderer.shadowMapType = THREE.PCFSoftShadowMap;
    
    /*оси*/
    axis = new THREE.AxisHelper(30);
    scene.add(axis);

    /* сетка */
    grid = new THREE.GridHelper(100, 25);
    color = new THREE.Color("rgb(255, 0, 0)");
    grid.setColors(color, 0x000000);
    grid.rotation.x = -0.5* Math.PI
    /*scene.add(grid);*/
    
    //шейдер неба
    var vertexShader = document.getElementById( 'vertexShader' ).textContent;
    var fragmentShader = document.getElementById( 'fragmentShader' ).textContent;
    var uniforms = {
        topColor:      { type: "c", value: new THREE.Color(0x000000) },
        bottomColor: { type: "c", value: new THREE.Color( 0x262626 ) },
        offset:         { type: "f", value: 100 },
        exponent:     { type: "f", value: 0.7 }
    }

    //сфера неба
    var skyGeo = new THREE.SphereGeometry( 300, 32, 15 );
    var skyMat = new THREE.ShaderMaterial( { vertexShader: vertexShader, fragmentShader: fragmentShader, uniforms: uniforms, side: THREE.BackSide } );

    var sky = new THREE.Mesh( skyGeo, skyMat );
    scene.add( sky );

    //маркеры калибровки
    var markGeom = new THREE.BoxGeometry(0.5, 0.5, 0.5, 2, 2, 2);
    var markMaterial = new THREE.MeshLambertMaterial({color: 0xff0000});
    this.marker6004 = new THREE.Mesh(markGeom, markMaterial);
    marker6004.position.set(39.682, 76.457, 7.6);
    scene.add(marker6004);

    this.marker6045 = new THREE.Mesh(markGeom, markMaterial);
    marker6045.position.set(30.141, 76.426, 8.7);
    scene.add(marker6045);

    this.marker6003 = new THREE.Mesh(markGeom, markMaterial);
    marker6003.position.set(39.8109, 59.531, 7.6);
    scene.add(marker6003);

    this.marker6012 = new THREE.Mesh(markGeom, markMaterial);
    marker6012.position.set(28.649, 59.256, 8.7);
    scene.add(marker6012);

    /* add collada import */
    var loader = new THREE.ColladaLoader();
    /*loader.options.convertUpAxis = true;*/
    loader.load( '/{{link}}', function ( collada ) {

        //функция поиска центра collada объекта на оси координат
        var getCenter = function(obj){
            minx = obj.min.x;
            miny = obj.min.y;
            minz = obj.min.z;

            maxx = obj.max.x;
            maxy = obj.max.y;
            maxz = obj.max.z;

            x = (minx - maxx);
            x = x - 2*x;

            y = (miny - maxy);
            y = y - 2*y;

            z = (minz - maxz);
            z = z - 2*z;

            a = {}
            a['x'] = minx + x/2;
            a['y'] = miny + y/2;
            a['z'] = minz + z/2;
            return a;
        }

    	//gls.dae
    	var dae = collada.scene;
    	dae.position.set(28.141,59.087,8.6);
    	dae.scale.set(1,1,1);
    	dae.rotation.z = - (Math.PI/2);
    	dae.rotation.x = Math.PI;
    	scene.add(dae);


        //****************************
        //**заполняем массив элементов сцены
        //**для передачи в панель управления dat.gui
        //****************************

        //**дерево
        colladaObjects['landscape'] = [];

        //**наполняем landscape
        colladaObjects['landscape'].push(dae['children'][0]['children'][0]);
        colladaObjects['landscape'][0].name = colladaObjects['landscape'][0]['parent']['name'];
            // ищем центр landscape
            lndscp = dae;
            var bbox = new THREE.Box3().setFromObject(lndscp);
            
            landscape = colladaObjects['landscape'][0];
            a = getCenter(bbox);
            landscape.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
        //**наполняем building
        var no = 0;
        $.each(colladaObjects['landscape'][0].parent.children, function(value){
            var landscape = colladaObjects['landscape'][0].parent.children[value];
            if (landscape.name.indexOf('building') != -1){
                colladaObjects['landscape'][0].children.push(landscape.children[0]);
                colladaObjects['landscape'][0]['children'][no]['name'] = colladaObjects['landscape'][0]['children'][no]['parent']['name'];
                    // ищем центр building
                    bld = colladaObjects['landscape'][0].children[no];
                    var bbox = new THREE.Box3().setFromObject(bld);
                    a = getCenter(bbox);
                    bld.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
                building = colladaObjects['landscape'][0]['children'][no].parent.children;
                //**наполняем floor
                var noFloor = 0
                $.each(building, function(value){
                    if (building[value].name.indexOf('floor') != -1){
                        colladaObjects['landscape'][0].children[no].children.push(building[value].children[0]);
                        colladaObjects['landscape'][0].children[no].children[noFloor].name = building[value].name;
                            // ищем центр floor
                            flr = colladaObjects['landscape'][0].children[no].children[noFloor];
                            var bbox = new THREE.Box3().setFromObject(flr);
                            a = getCenter(bbox);
                            flr.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
                        //** наполняем kabinet и outer
                        floor = colladaObjects['landscape'][0]['children'][no]['children'][noFloor].parent.children;
                        var noKabinet = 0;
                        $.each(floor, function(value){
                            if(floor[value].name.indexOf('kabinet') != -1){
                                colladaObjects['landscape'][0].children[no]['children'][noFloor].children.push(floor[value].children[0]);
                                colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet].name = floor[value].name;
                                    // ищем центр kabinet
                                    kbnt = colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet];
                                    var bbox = new THREE.Box3().setFromObject(kbnt);
                                    a = getCenter(bbox);
                                    kbnt.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
                                //** наполняем wall
                                kabinet = colladaObjects['landscape'][0]['children'][no]['children'][noFloor]['children'][noKabinet].parent.children;
                                var noWall = 0;
                                $.each(kabinet, function(value){
                                    if(kabinet[value].name.indexOf('wall') != -1){
                                        colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet].children.push(kabinet[value].children[0]);
                                        colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet].children[noWall].name = kabinet[value].name
                                            // ищем центр wall
                                            // пока оставим пустым, возможно не потребуется
                                        noWall += 1;
                                    }
                                });
                                noKabinet += 1;
                            }
                            if (floor[value].name.indexOf('outer') != -1){
                                colladaObjects['landscape'][0].children[no]['children'][noFloor].children.push(floor[value].children[0]);
                                colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet].name = floor[value].name;
                                    // ищем центр outer
                                    outr = colladaObjects['landscape'][0].children[no]['children'][noFloor].children[noKabinet];
                                    var bbox = new THREE.Box3().setFromObject(outr);
                                    a = getCenter(bbox);
                                    outr.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
                                noKabinet += 1
                            }
                        });
                        noFloor += 1;
                    }
                });
                no += 1;
            }
            // наполняем light
            if (landscape.name.indexOf('light') != -1){
                colladaObjects['landscape'][0].children.push(landscape.children[0]);
                colladaObjects['landscape'][0]['children'][no]['name'] = colladaObjects['landscape'][0]['children'][no]['parent']['name'];
                var light = colladaObjects['landscape'][0]['children'][no];
                    // ищем центр light
                    lght = colladaObjects['landscape'][0].children[no];
                    var bbox = new THREE.Box3().setFromObject(lght);
                    a = getCenter(bbox);
                    lght.Center = new THREE.Vector3(a['x'], a['y'], a['z']);
                no += 1;
            }
        });

        //****************************
        //**конец заполнения массива элементов сцены
        //****************************

        /*console.log(colladaObjects);*/
        //** добавляем папку "Визуализация"
        /*datGUI = new dat.GUI();
        var bfolder = datGUI.addFolder('Визулизация');
        guiControls = new function(){
            //свойство "Видимость"
            this.видимость = true;
            //свойство "Прозрачность"
            this.прозрачность = 0.5;
        }
        var buildingObject = colladaObjects['landscape'][0].children[no];
        //обработчик "Видимость"
        bfolder.add(guiControls, 'видимость').onChange(function(value){
            togleVisible(buildingObject.parent, value);
        });
        //обработчик "Прозрачность"
        bfolder.add(guiControls, 'прозрачность', 0, 1).onChange(function(value){
            togleOpacity(buildingObject, value);
        });        
        datGUI.close();*/


        //****************************
        //**настройки сцены по умолчанию
        //****************************

    	//landscape 
    	plane = colladaObjects['landscape'][0];
    	setMaterialObject(plane, new THREE.MeshPhongMaterial({ color: 0x803131 }));
    	//building
        $.each(colladaObjects['landscape'][0].children, function(value){
            if (colladaObjects['landscape'][0].children[value].name.indexOf('building') != -1){
                building = colladaObjects['landscape'][0].children[value];
                building.visible = false;
                $.each(building.children, function(value){
                    //floor
                    floor = building.children[value];
                    setMaterialObject(floor, new THREE.MeshPhongMaterial({color: 0x008080, transparent:true}));
                    //kabinet n outer
                    $.each(floor.children, function(value){
                        if (floor.children[value].name.indexOf('outer') != -1){
                            outer = floor.children[value];
                            setMaterialObject(outer, new THREE.MeshPhongMaterial({color: 0x6b002b, transparent:true}));
                        } else if (floor.children[value].name.indexOf('kabinet') != -1){
                            kabinet = floor.children[value];
                            kabinet.visible = false;
                            //wall
                            $.each(kabinet.children, function(value){
                                wall = kabinet.children[value];
                                setMaterialObject(wall, new THREE.MeshPhongMaterial({color: 0x193434, transparent:true}));
                            });
                        }
                    });
                });
            }
            if (colladaObjects['landscape'][0].children[value].name.indexOf('light') != -1){
                light = colladaObjects['landscape'][0].children[value];
                light.visible = false;
                a = light.Center;
                spotLight = new THREE.SpotLight(0xffffff);
                spotLight.castShadow = true;
                spotLight.position.set (a['x'], a['y'], a['z']);
                spotLight.target.position.set(a['x'], a['y'], a['z']+60);
                this.lightX = 20;
                this.lightY = 35;
                this.lightZ = 40;
                this.intensity = 5;
                this.decay = 8.5;   
                this.distance = 87;
                this.angle = 0.54;
                this.exponent = 0;
                this.shadowCameraNear = 10;
                this.shadowCameraFar = 100;
                this.shadowCameraFov = 50;
                this.shadowCameraVisible=false;
                this.shadowMapWidth=1028;
                this.shadowMapHeight=1028;
                this.shadowBias=0;
                this.shadowDarkness=0.5;
                spotLight.target.updateMatrixWorld();
                scene.add(spotLight);
            }
        });
        //*************************************
        //**Загрузка данных в панель управления
        //*************************************

        //*************************************
        //**конец загрузки данных в панель управления
        //***********************************
    });

    //изменить материал для обектов
    var setMaterialObject = function(obj, material) {
    	obj.material = material;
	}

    //изменить материал для дочерних объектов
    var setMaterialNode = function(node, material) {
		node.material = material;
		if (node.children) {
			for (var i = 0; i < node.children.length; i++) {
  				setMaterialNode(node.children[i], material);
			}
		}
	}

    //изменение видимости дочерних объектов
    var togleVisible = function(node, bool){
        node.visible = bool;
        if (node.children) {
            for (var i = 0; i < node.children.length; i++) {
                togleVisible(node.children[i], bool);
            }
        }
    }

    //изменение прозрачности дочерних объектов
    var togleOpacity = function(node, floatVal){
        node.material.opacity = floatVal;
        node.material.transparent = true;
        if (node.parent.children) {
            for (var i = 0; i < node.parent.children.length; i++) {
                togleOpacity(node, floatVal);
            }
        }
    }

              
	/* позиция камеры по умолчанию */
    camera.position.set(69, 69, -50);
    /* вверх - это Z*/
    camera.up.set( 0, 0, -1 );
    scene.add(camera);


    /*камера. контроль за сменой позиции*/
    controls = new THREE.OrbitControls( camera, renderer.domElement );
    /* камера вращается вокруг данных координат*/
    controls.target.copy(new THREE.Vector3(34.141, 67.862, 8.6));
    //камера смотрит
    camera.lookAt(new THREE.Vector3(34.141, 67.862, 8.6));
    controls.addEventListener( 'change', render );
    hemi = new THREE.HemisphereLight(0xbbbbbb, 0x0099FF);
    scene.add(hemi);

    $("#webGL-container").append(renderer.domElement);

    /*статистика*/
    stats = new Stats();        
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.left = '0px';
    stats.domElement.style.top = '0px';     
    $("#webGL-container").append( stats.domElement );       
	  }

    function render(){

    	if ($.isEmptyObject(unique)==false){
				//проверка наличия элемента на сцене
				$.each(unique, function(index){
					if (unique[index]['mesh']==undefined){
						//добавление элемента на сцену
						unique[index]['mesh'] = new THREE.Mesh(cubeGeom, cubeMaterial);
						scene.add(unique[index]['mesh']);
					}
				});

				$.each(unique, function(index){
					var timeOut = 5000;
					ind = index;
					//прохождение позиций координат
					$.each(unique[ind]['data'], function(index){
						if (unique[ind]['data'][index] != undefined){
							x = unique[ind]['data'][index]['x'];
							y = unique[ind]['data'][index]['y'];
							z = unique[ind]['data'][index]['z'];
							//отрисовка перемещений
							//установка временного интервала
							if (unique[ind]['count'] != 0){
								timeOut = timeOut/unique[ind]['count'];
							}

							unique[ind]['mesh'].position.set(x,y,z);

							timeOut += timeOut;
							//удаление пройденных координат из буфера
							unique[ind]['data'] = jQuery.grep(unique[ind]['data'], function(value){
								return value != unique[ind]['data'][index];
							});

							//проверить, если давно не поступает сигнал удалить из буфера
							/*delay = 20000;
							var a = unique[index]['cron'];
								if (a > delay){
									unique[index]['removed'] = 1;
									scene.remove(unique[index]['mesh']);
								}
								//если сигнал посупил, снова добавить
							if (a < delay && unique[index]['removed'] == 1){
									unique[index]['mesh'] = new THREE.Mesh(cubeGeom, cubeMaterial);
									scene.add(unique[index]['mesh']);
									unique[index]['removed'] = 0;
							}*/
						}
					});
					//oчищаем count
					unique[ind]['count'] = 0;
				});
    	}

    }

    function update(){
    }

    function animate(){
        requestAnimationFrame(animate);
        render();
        update();
        stats.update();     
        renderer.render(scene, camera);
    }

    init();
    animate();


    $(window).resize(function(){
        SCREEN_WIDTH = window.innerWidth;
        SCREEN_HEIGHT = window.innerHeight;
        camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;
        camera.updateProjectionMatrix();
        renderer.setSize( SCREEN_WIDTH, SCREEN_HEIGHT );
    });

	</script>
    <script src="{% static 'js/foundation.js' %}"></script>
    <script src="{% static 'js/vendor/what-input.min.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.slider.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.tabs.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.util.keyboard.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.util.timerAndImageLoader.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.drilldown.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.util.motion.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.util.nest.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.util.mediaQuery.js' %}"></script>
    <script src="{% static 'js/vendor/foundation.accordionMenu.js' %}"></script>
    <script>
        $(document).foundation();
        $('.is-drilldown').css('max-height', '300px');
    </script>
	</body>
</html>